<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í”Œë ˆì´ì–´ë¸” ê´‘ê³  ë°ëª¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      background: #111;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    /* ê´‘ê³  ì˜ì—­ (ì‹¤ì œë¡œëŠ” WebView/iframe ì•ˆì— ë“¤ì–´ê°€ëŠ” ì˜ì—­ì´ë¼ê³  ë³´ë©´ ë¨) */
    .game-wrapper {
      width: 320px;
      height: 568px;
      background: linear-gradient(160deg, #181b2c, #090b12);
      border-radius: 16px;
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.5);
      padding: 16px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      overflow: hidden;
      position: relative;
    }

    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      opacity: 0.9;
    }

    .logo {
      font-weight: 700;
      font-size: 14px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      font-size: 10px;
    }

    .game-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      gap: 12px;
    }

    .title {
      font-size: 20px;
      font-weight: 700;
    }

    .subtitle {
      font-size: 13px;
      opacity: 0.8;
      line-height: 1.4;
      padding: 0 12px;
    }

    .status {
      display: flex;
      justify-content: center;
      gap: 16px;
      font-size: 12px;
      margin-top: 6px;
    }

    .status span {
      opacity: 0.9;
    }

    .highlight {
      color: #ffd54f;
      font-weight: 600;
    }

    .cards {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 12px;
    }

    .card {
      width: 72px;
      height: 90px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 34px;
      cursor: pointer;
      user-select: none;
      transition: transform 0.08s ease, background 0.1s ease;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .card:active {
      transform: scale(0.94);
      background: rgba(255, 255, 255, 0.13);
    }

    .card.disabled {
      opacity: 0.4;
      pointer-events: none;
    }

    .game-footer {
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 10px;
      opacity: 0.7;
    }

    .primary-btn {
      width: 100%;
      padding: 10px 0;
      border-radius: 999px;
      border: none;
      background: #ffca28;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      margin-top: 4px;
      color: #181818;
    }

    .primary-btn:active {
      transform: translateY(1px);
      opacity: 0.9;
    }

    .hidden {
      display: none !important;
    }

    .badge {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(76, 175, 80, 0.1);
      border: 1px solid rgba(76, 175, 80, 0.5);
      color: #c8e6c9;
      margin-top: 4px;
    }

    .timer-bar-wrap {
      width: 100%;
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 999px;
      overflow: hidden;
      margin-top: 10px;
    }

    .timer-bar {
      height: 100%;
      width: 100%;
      background: #ff5252;
      transform-origin: left center;
      transform: scaleX(1);
      transition: transform 0.12s linear;
    }

    .result-title {
      font-size: 22px;
      font-weight: 800;
    }

    .result-text {
      font-size: 13px;
      opacity: 0.85;
      margin-top: 6px;
    }

    .cta-note {
      font-size: 11px;
      opacity: 0.75;
      margin-top: 2px;
    }
  </style>
</head>
<body>
  <div class="game-wrapper">
    <!-- ìƒë‹¨ ì˜ì—­ -->
    <div class="game-header">
      <div class="logo">GAME DEMO</div>
      <div class="tag" id="phase-label">íŠœí† ë¦¬ì–¼</div>
    </div>

    <!-- ë©”ì¸ ì˜ì—­ -->
    <div class="game-main" id="screen-intro">
      <div class="title">10ì´ˆ ì•ˆì—<br />ì›ƒëŠ” ì–¼êµ´ë§Œ ì¡ì•„ë´!</div>
      <div class="subtitle">
        ğŸ˜ƒ ì´ëª¨ì§€ë§Œ ê³¨ë¼ì„œ <span class="highlight">5ë²ˆ</span> ë§ì¶”ë©´,<br />
        ì‹¤ì œ ê²Œì„ì²˜ëŸ¼ ì´ì–´ì§€ëŠ” <span class="highlight">í”Œë ˆì´ì–´ë¸”</span> ë°ëª¨ì•¼.
      </div>
      <div class="badge">í™”ë©´ì„ íƒ­í•´ì„œ ë°”ë¡œ ì‹œì‘í•´ë³´ì„¸ìš”</div>
      <button class="primary-btn" id="start-btn">ê²Œì„ ì‹œì‘</button>
    </div>

    <div class="game-main hidden" id="screen-game">
      <div class="title">ì–´ë””ì— ìˆì„ê¹Œ? ğŸ‘€</div>
      <div class="subtitle">
        10ì´ˆ ì•ˆì— <span class="highlight">ğŸ˜ƒ</span>ë§Œ í´ë¦­í•´ì„œ<br />
        5ì ì„ ì±„ì›Œë³´ì„¸ìš”!
      </div>

      <div class="status">
        <span>ë‚¨ì€ ì‹œê°„: <span id="time-left">10.0</span>s</span>
        <span>ì ìˆ˜: <span id="score">0</span>/5</span>
      </div>

      <div class="cards" id="cards-wrap">
        <!-- JSë¡œ ì¹´ë“œê°€ ì±„ì›Œì§ -->
      </div>

      <div class="timer-bar-wrap">
        <div class="timer-bar" id="timer-bar"></div>
      </div>
    </div>

    <div class="game-main hidden" id="screen-result">
      <div id="result-success" class="">
        <div class="result-title">ì„±ê³µ! ğŸ‰</div>
        <div class="result-text">
          ë‹¹ì‹ ì˜ ìˆœë°œë ¥, ìš°ë¦¬ ê²Œì„ì— ë”±ì´ì—ìš”.<br />
          ì§€ê¸ˆ ë°”ë¡œ ì´ì–´ì„œ í”Œë ˆì´í•´ë³´ì„¸ìš”.
        </div>
        <button class="primary-btn" id="cta-btn">
          ì§€ê¸ˆ ë°”ë¡œ ì„¤ì¹˜í•˜ê³  ê³„ì†í•˜ê¸°
        </button>
        <div class="cta-note">
          * ë²„íŠ¼ í´ë¦­ ì‹œ ì•± ìŠ¤í† ì–´ ë˜ëŠ” ëœë”© í˜ì´ì§€ë¡œ ì´ë™í•˜ë„ë¡
          ì—°ë™í•©ë‹ˆë‹¤.
        </div>
      </div>

      <div id="result-fail" class="hidden">
        <div class="result-title">ì•„ì‰½ë„¤ìš”! ğŸ˜¢</div>
        <div class="result-text">
          ê±°ì˜ ë‹¤ ì™”ì–´ìš”.<br />
          ì‹¤ì œ ê²Œì„ì—ì„œëŠ” ë” ì—¬ìœ ë¡­ê²Œ ë„ì „í•´ë³¼ ìˆ˜ ìˆì–´ìš”.
        </div>
        <button class="primary-btn" id="retry-btn">ë‹¤ì‹œ ë„ì „í•˜ê¸°</button>
      </div>
    </div>

    <!-- í•˜ë‹¨ ì„¤ëª… -->
    <div class="game-footer">
      <div>ì´ ë°ëª¨ëŠ” HTML5ë¡œ ë§Œë“  <b>í”Œë ˆì´ì–´ë¸” ê´‘ê³  ì˜ˆì‹œ</b>ì…ë‹ˆë‹¤.</div>
      <div>
        ì‹¤ì œ ì§‘í–‰ ì‹œì—ëŠ” SDKì—ì„œ WebViewë¡œ ì´ íŒŒì¼ì„ ë¡œë”©í•˜ê³ ,<br />
        CTA í´ë¦­ ì‹œ ì•± ìŠ¤í† ì–´ë‚˜ ëœë”© URLë¡œ ì—°ë™í•©ë‹ˆë‹¤.
      </div>
    </div>
  </div>

  <script>
    // ê°„ë‹¨í•œ ìƒíƒœ ë³€ìˆ˜ë“¤
    const GAME_DURATION = 10_000; // 10ì´ˆ
    const TARGET_SCORE = 5;

    let score = 0;
    let timeLeft = GAME_DURATION; // ms
    let timerId = null;
    let lastTick = null;
    let gameEnded = false;

    // DOM ìš”ì†Œ
    const screenIntro = document.getElementById("screen-intro");
    const screenGame = document.getElementById("screen-game");
    const screenResult = document.getElementById("screen-result");
    const startBtn = document.getElementById("start-btn");
    const retryBtn = document.getElementById("retry-btn");
    const ctaBtn = document.getElementById("cta-btn");
    const phaseLabel = document.getElementById("phase-label");
    const timeLeftEl = document.getElementById("time-left");
    const scoreEl = document.getElementById("score");
    const timerBar = document.getElementById("timer-bar");
    const cardsWrap = document.getElementById("cards-wrap");
    const resultSuccess = document.getElementById("result-success");
    const resultFail = document.getElementById("result-fail");

    function showScreen(id) {
      screenIntro.classList.add("hidden");
      screenGame.classList.add("hidden");
      screenResult.classList.add("hidden");

      if (id === "intro") screenIntro.classList.remove("hidden");
      if (id === "game") screenGame.classList.remove("hidden");
      if (id === "result") screenResult.classList.remove("hidden");
    }

    function resetGame() {
      score = 0;
      timeLeft = GAME_DURATION;
      lastTick = null;
      gameEnded = false;
      timerBar.style.transform = "scaleX(1)";
      scoreEl.textContent = score;
      timeLeftEl.textContent = (timeLeft / 1000).toFixed(1);
      phaseLabel.textContent = "í”Œë ˆì´ ì¤‘";
      clearInterval(timerId);
      timerId = null;
      createNewRound();
    }

    function startGame() {
      showScreen("game");
      resetGame();
      lastTick = performance.now();

      timerId = requestAnimationFrame(updateTimer);
    }

    function updateTimer(now) {
      if (gameEnded) return;
      if (!lastTick) lastTick = now;

      const delta = now - lastTick;
      lastTick = now;
      timeLeft -= delta;

      if (timeLeft < 0) timeLeft = 0;

      timeLeftEl.textContent = (timeLeft / 1000).toFixed(1);
      const progress = timeLeft / GAME_DURATION;
      timerBar.style.transform = `scaleX(${progress})`;

      if (timeLeft <= 0) {
        endGame(score >= TARGET_SCORE);
      } else {
        timerId = requestAnimationFrame(updateTimer);
      }
    }

    function endGame(isSuccess) {
      gameEnded = true;
      phaseLabel.textContent = "ê²°ê³¼";

      // ì¹´ë“œ í´ë¦­ ë§‰ê¸°
      const allCards = document.querySelectorAll(".card");
      allCards.forEach((c) => c.classList.add("disabled"));

      showScreen("result");
      if (isSuccess) {
        resultSuccess.classList.remove("hidden");
        resultFail.classList.add("hidden");
      } else {
        resultSuccess.classList.add("hidden");
        resultFail.classList.remove("hidden");
      }

      // ì—¬ê¸°ì„œ ì‹¤ì œ SDKì— "ê²Œì„ ì¢…ë£Œ/ìŠ¹íŒ¨" ì´ë²¤íŠ¸ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŒ
      // ì˜ˆ: window.parent.postMessage({ type: 'game_end', success: isSuccess }, '*');
    }

    function createNewRound() {
      cardsWrap.innerHTML = "";

      // ì¹´ë“œ 3ê°œ ì¤‘ ëœë¤ìœ¼ë¡œ í•˜ë‚˜ë§Œ ğŸ˜ƒ, ë‚˜ë¨¸ì§€ëŠ” ğŸ˜ˆ
      const positions = [0, 1, 2];
      const correctIndex = positions[Math.floor(Math.random() * positions.length)];

      positions.forEach((pos, i) => {
        const card = document.createElement("div");
        card.className = "card";
        const isCorrect = i === correctIndex;
        card.textContent = isCorrect ? "ğŸ˜ƒ" : "ğŸ˜ˆ";

        card.addEventListener("click", () => {
          if (gameEnded) return;

          if (isCorrect) {
            score++;
            scoreEl.textContent = score;

            // ê°„ë‹¨í•œ í”¼ë“œë°±
            card.style.transform = "scale(1.1)";
            setTimeout(() => {
              card.style.transform = "scale(1)";
            }, 80);

            if (score >= TARGET_SCORE) {
              endGame(true);
            } else {
              // ë‹¤ìŒ ë¼ìš´ë“œ
              setTimeout(createNewRound, 150);
            }
          } else {
            // ì˜¤ë‹µ í´ë¦­ ì‹œ ì‚´ì§ í”ë“¤ë¦¼ íš¨ê³¼ë§Œ (íŒ¨ë„í‹° ì—†ìŒ)
            card.style.transform = "translateY(4px)";
            setTimeout(() => {
              card.style.transform = "translateY(0)";
            }, 80);
          }
        });

        cardsWrap.appendChild(card);
      });
    }

    // ë²„íŠ¼ ì´ë²¤íŠ¸
    startBtn.addEventListener("click", () => {
      startGame();
      // ì—¬ê¸°ì„œ "ê²Œì„ ì‹œì‘" ì´ë²¤íŠ¸ë¥¼ SDKë¡œ ë³´ë‚¼ ìˆ˜ë„ ìˆìŒ
      // window.parent.postMessage({ type: 'game_start' }, '*');
    });

    if (retryBtn) {
      retryBtn.addEventListener("click", () => {
        showScreen("game");
        startGame();
      });
    }

    if (ctaBtn) {
      ctaBtn.addEventListener("click", () => {
        // TODO: ì‹¤ì œ ëœë”© / ì•±ìŠ¤í† ì–´ URLë¡œ êµì²´
        const landingUrl = "https://example.com"; // ì—¬ê¸°ì— ì§„ì§œ URL
        // ê´‘ê³  ë„¤íŠ¸ì›Œí¬ WebView ì•ˆì´ë¼ë©´:
        // window.parent.postMessage({ type: 'cta_click' }, '*');
        window.open(landingUrl, "_blank");
      });
    }

    // ìµœì´ˆ ì§„ì…ì€ ì¸íŠ¸ë¡œ í™”ë©´
    showScreen("intro");
  </script>
</body>
</html>
